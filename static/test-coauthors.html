<!DOCTYPE html>
<html>
<head>
    <title>Co-authors Test</title>
</head>
<body>
    <h1>Testing Co-author Display</h1>
    <div id="test-output"></div>
    
    <script>
    // Test data matching what we have in publications.json
    const testPub = {
        "title": "Zeit und Raum. Visualisierung und Analyse von Geodaten über Transaktionen mit Basler Liegenschaften in der Vormoderne",
        "year": "2025",
        "authors": [
            {"name": "Tobias Hodel", "is_primary": true},
            {"name": "Anna Müller", "is_primary": false}
        ],
        "coauthored": true,
        "doi": null
    };

    function formatAuthors(authors) {
        if (!authors || authors.length === 0) return '';
        
        const sorted = authors.sort((a, b) => {
            if (a.is_primary && !b.is_primary) return -1;
            if (!a.is_primary && b.is_primary) return 1;
            return 0;
        });
        
        const names = sorted.map(a => a.name);
        
        if (names.length === 1) return names[0];
        if (names.length === 2) return `${names[0]} & ${names[1]}`;
        return `${names.slice(0, -1).join(', ')} & ${names[names.length - 1]}`;
    }

    // Test the logic
    const authors = formatAuthors(testPub.authors);
    const title = testPub.title;
    
    let citation = title;
    if (authors && testPub.coauthored) {
        citation = `<strong>${authors}</strong> (${testPub.year}). ${title}`;
    } else if (testPub.year) {
        citation = `${title} (${testPub.year})`;
    }
    
    document.getElementById('test-output').innerHTML = `
        <p><strong>Raw data:</strong></p>
        <p>Authors: ${JSON.stringify(testPub.authors)}</p>
        <p>Coauthored: ${testPub.coauthored}</p>
        <p><strong>Formatted authors:</strong> "${authors}"</p>
        <p><strong>Final citation:</strong></p>
        <p>${citation}</p>
    `;
    </script>
</body>
</html>
